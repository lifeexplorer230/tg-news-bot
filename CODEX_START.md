# Инструкция для codex: Запуск работы над улучшениями

## Контекст

Ты работаешь над проектом Marketplace News Bot в директории `/root/marketplace-news-bot`.

Все критические задачи уже выполнены. Остались опциональные улучшения (~13.5 часов работы), разбитые на 5 этапов.

## Система документов

**Обязательно прочитай перед началом работы:**

1. **DOROZHNAYA_KARTA.md** - главная дорожная карта с этапами A-E
2. **INSTRUKTSIYA_VYPOLNENIYA.md** - чек-листы для каждой задачи
3. **memory-bank/pravila.md** - правила работы с проектом
4. **memory-bank/arkhitektura.md** - архитектура (если нужен контекст)

## Протокол работы

### Этап A: Простая очистка кода (1 час)

```bash
# Задачи:
- E1: Удалить неиспользуемые импорты (services/marketplace_processor.py)
- C10: Добавить docstrings (marketplace_processor.py:270-290)
- C3: Удалить закомментированный код (telegram_listener.py:150-180)
- C8: Логировать ID публикуемого сообщения (marketplace_processor.py:500-520)
```

**Команды для выполнения:**

1. Прочитай DOROZHNAYA_KARTA.md, найди этап A
2. Прочитай INSTRUKTSIYA_VYPOLNENIYA.md, секцию "Этап A"
3. Прочитай memory-bank/pravila.md
4. Для каждой задачи:
   - Следуй чек-листу из INSTRUKTSIYA
   - Делай маленькие коммиты
   - Запускай тесты после каждого изменения
   - Обновляй статус в DOROZHNAYA_KARTA.md (⏳ → ✅)
5. После завершения этапа добавь запись в журнал работы

**Проверка:**
```bash
python -m pytest
ruff check .
```

### Следующие этапы

- **Этап B**: Очистка legacy (2 часа)
- **Этап C**: Архитектура (3 часа)
- **Этап D**: Расширяемость (3 часа)
- **Этап E**: Производительность (4.5 часа)

## Важные правила

❌ **НЕ трогать:**
- database/db.py (уже оптимизирован)
- Timezone логику (работает корректно)
- Telegram sessions (уже разделены)

✅ **Можно:**
- Рефакторинг marketplace_processor.py
- Добавление docstrings
- Удаление неиспользуемого кода
- Улучшение логирования

## Формат обновления дорожной карты

После завершения задачи обнови DOROZHNAYA_KARTA.md:

```markdown
| E1 | Удалить неиспользуемые импорты | marketplace_processor.py | 15 мин | ✅ | `ruff check` |
```

И добавь в журнал:

```markdown
### 2025-10-12 XX:XX - Этап A

**Задачи:**
- [x] E1: Удалены импорты (ruff check пройден)
- [x] C10: Добавлены docstrings
- [ ] C3: В процессе

**Результат:** 2/4 задачи этапа A завершены
**Следующий шаг:** Завершить C3, C8
**Проблемы:** Нет
```

## Команды для работы

```bash
# Перейти в проект
cd /root/marketplace-news-bot

# Прочитать контекст
cat DOROZHNAYA_KARTA.md
cat INSTRUKTSIYA_VYPOLNENIYA.md
cat memory-bank/pravila.md

# Начать этап A
# ... выполнение задач по чек-листу ...

# Проверка после каждой задачи
python -m pytest
ruff check .
git add . && git commit -m "E1: Remove unused imports"
```

---

**Готово к старту! Начинай с этапа A.**
