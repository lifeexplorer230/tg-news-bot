# üó∫Ô∏è –î–û–†–û–ñ–ù–ê–Ø –ö–ê–†–¢–ê: TELEGRAM NEWS BOT ‚Äî –°–¢–ê–ë–ò–õ–ò–ó–ê–¶–ò–Ø –ò –†–ê–ó–í–ò–¢–ò–ï

**–í–µ—Ä—Å–∏—è:** 1.0.0
**–î–∞—Ç–∞ –∑–∞–ø—É—Å–∫–∞ —Ü–∏–∫–ª–∞:** 2025-10-14
**–°—Ç–∞—Ç—É—Å:** üü¢ –ê–∫—Ç–∏–≤–Ω–∞

---

## üìå –ö–æ–Ω—Ç–µ–∫—Å—Ç –∏ —Ü–µ–ª–∏

| –ê—Å–ø–µ–∫—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|
| **–ù–∞—Å–ª–µ–¥–∏–µ** | –ü—Ä–æ–µ–∫—Ç tg-news-bot –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω –∏–∑ marketplace-news-bot —Å –±–∞–∑–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é: listener, processor, Gemini AI, embeddings, –ø—Ä–æ—Ñ–∏–ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏. FloodWait protection –¥–æ–±–∞–≤–ª–µ–Ω 2025-10-14. |
| **–ó–∞–ø—Ä–æ—Å** | –°—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É, –¥–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ, —É–ª—É—á—à–∏—Ç—å –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∫ production deployment. |
| **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è** | –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å marketplace-news-bot, SQLite –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π storage, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ breaking changes –≤ API. |
| **–¶–µ–ª—å** | –î–æ–≤–µ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç –¥–æ production-ready —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å coverage > 70%, –ø–æ–ª–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π, CI/CD pipeline, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –∏ operational procedures. |

---

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏

1. **–°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è –±–∞–∑–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ listener, processor, database, —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –±–∞–≥–æ–≤.
2. **–¢–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ** ‚Äî unit-—Ç–µ—Å—Ç—ã –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã, coverage > 70%.
3. **–£–ª—É—á—à–µ–Ω–∏–µ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏** ‚Äî Gemini retry –ª–æ–≥–∏–∫–∞, DB concurrency, graceful shutdown, error recovery.
4. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** ‚Äî lazy loading, batch operations, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ.
5. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ CI/CD** ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è, GitHub Actions, pre-commit hooks, release –ø—Ä–æ—Ü–µ–¥—É—Ä—ã.

---

## ‚öñÔ∏è –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –í–∞—Ä–∏–∞–Ω—Ç A: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ñ–∏–∫—Å—ã | –í–∞—Ä–∏–∞–Ω—Ç B: –ü–æ–ª–Ω–∞—è —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è (–≤—ã–±—Ä–∞–Ω) | –í–∞—Ä–∏–∞–Ω—Ç C: –ü–æ–ª–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ |
|----------|------------------------------|------------------------------------------|-------------------------------|
| –í—Ä–µ–º—è –¥–æ production | –ù–∏–∑–∫–æ–µ (1 –Ω–µ–¥–µ–ª—è) | –°—Ä–µ–¥–Ω–µ–µ (2-3 –Ω–µ–¥–µ–ª–∏) | –í—ã—Å–æ–∫–æ–µ (1-2 –º–µ—Å—è—Ü–∞) |
| –†–∏—Å–∫ —Ä–µ–≥—Ä–µ—Å—Å–∏–π | –í—ã—Å–æ–∫–∏–π | –°—Ä–µ–¥–Ω–∏–π (–ø–æ–∫—Ä—ã—Ç —Ç–µ—Å—Ç–∞–º–∏) | –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∏–π |
| –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞ | –ù–∏–∑–∫–æ–µ | –í—ã—Å–æ–∫–æ–µ | –û—á–µ–Ω—å –≤—ã—Å–æ–∫–æ–µ |
| Maintainability | –ù–∏–∑–∫–∞—è | –í—ã—Å–æ–∫–∞—è | –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è |
| Coverage | < 30% | > 70% | > 90% |
| –í—ã–≤–æ–¥ | –ë—ã—Å—Ç—Ä–æ –Ω–æ –Ω–µ–Ω–∞–¥–µ–∂–Ω–æ | ‚úÖ **–í—ã–±—Ä–∞–Ω** | –°–ª–∏—à–∫–æ–º –¥–æ–ª–≥–æ |

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –≤—ã–±–æ—Ä–∞ B:**
–ë–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Å–∫–æ—Ä–æ—Å—Ç—å—é –∏ –∫–∞—á–µ—Å—Ç–≤–æ–º. –¢–µ—Å—Ç—ã –æ–±–µ—Å–ø–µ—á–∞—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å, –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å, –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã —É–ø—Ä–æ—Å—Ç—è—Ç –ø–æ–¥–¥–µ—Ä–∂–∫—É.

---

## üß≠ –ü–æ–¥—Ö–æ–¥

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø–∞—Ä—Ç–∏–∏
- –°–ª–µ–¥—É–µ–º –ø—Ä–∏–Ω—Ü–∏–ø—É **diff-limit**: –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –≥—Ä–∞–Ω–∏—Ü–∞ **150 —Å—Ç—Ä–æ–∫**, warning **300 —Å—Ç—Ä–æ–∫**, fail **> 500 —Å—Ç—Ä–æ–∫**
- –ö–∞–∂–¥–∞—è –ø–∞—Ä—Ç–∏—è = –æ–¥–∏–Ω –ª–æ–≥–∏—á–µ—Å–∫–∏–π –±–ª–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ limit ‚Äî —Ä–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ –º–µ–Ω—å—à–∏–µ —á–∞—Å—Ç–∏
- **Escalation —á–µ—Ä–µ–∑ "–æ–±—Å—Ç—É–∫–∏–≤–∞–Ω–∏–µ —Ç—É–Ω–Ω–µ–ª—è"**: –ø—Ä–æ–±–Ω—ã–π –∫–æ–º–º–∏—Ç ‚Üí –∞–Ω–∞–ª–∏–∑ ‚Üí –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ —Ä–∞–∑–º–µ—Ä–∞

### –î–≤–æ–π–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
- –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –ø–∞—Ä—Ç–∏–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã:
  - `git diff --stat` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π
  - –†–µ–≤–∏–∑–∏—è —á–µ—Ä–µ–∑ `memory-bank/verification-protocol.md`
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∂—É—Ä–Ω–∞–ª–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
  - –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ (–µ—Å–ª–∏ –µ—Å—Ç—å)

### –¢–æ—á–∫–∏ –æ—Ç–∫–∞—Ç–∞
- –ù–∞ —Å—Ç—ã–∫–µ —ç—Ç–∞–ø–æ–≤ A‚ÄìE —Å–æ–∑–¥–∞—ë–º **snapshot commits**
- –§–∏–∫—Å–∏—Ä—É–µ–º –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Ç–µ–≥–∏: `v1.0.0-stageA`, `v1.0.0-stageB`
- –°–æ—Ö—Ä–∞–Ω—è–µ–º baseline –≤ `snapshot/` (–ª–æ–∫–∞–ª—å–Ω–æ, –Ω–µ –≤ git)
- –ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö ‚Äî –æ—Ç–∫–∞—Ç —á–µ—Ä–µ–∑ `git checkout <tag>`

### –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–∏—Ñ—Ñ–æ–≤
- –ö–∞–∂–¥–∞—è –ø–æ–¥–∑–∞–¥–∞—á–∞ ‚Üí **–æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–º–º–∏—Ç**
- –í PR –ø–æ–ø–∞–¥–∞–µ—Ç **–ª–∏–Ω–µ–π–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è**
- –ü–æ—Å–ª–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞: —É–º–µ–Ω—å—à–∞–µ–º –ø–∞—Ä—Ç–∏—é, –æ–±–Ω–æ–≤–ª—è–µ–º `diff-limit-plan.md`
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ squash commits –¥–æ review

### –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –≤–Ω–µ git
- **–í git:** `.gitkeep`, –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞, —Ç–µ—Å—Ç—ã
- **–õ–æ–∫–∞–ª—å–Ω–æ:** –ª–æ–≥–∏, snapshots, baseline, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
  ```
  logs/         # –õ–æ–≥–∏ (–≤ git —Ç–æ–ª—å–∫–æ .gitkeep)
  snapshot/     # Baseline —Å–Ω–∞–ø—à–æ—Ç—ã (–ª–æ–∫–∞–ª—å–Ω–æ)
  data/         # –ë–î –∏ embeddings (–ª–æ–∫–∞–ª—å–Ω–æ)
  ```

### –ü—Ä–æ—Ç–æ–∫–æ–ª —Ä–∞–±–æ—Ç—ã
- –õ—é–±–∞—è —Ä–∞–±–æ—á–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è —Å—Ç–∞—Ä—Ç—É–µ—Ç –∫–æ–º–∞–Ω–¥–æ–π: **`–ü—Ä–æ—Ç–æ–∫–æ–ª, —à–∞–≥ <–∫–æ–¥>`**
- –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å: **Memory ‚Üí Roadmap ‚Üí Instruction ‚Üí Execute ‚Üí Update**
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∂—É—Ä–Ω–∞–ª–∞ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞

---

## üî¢ –≠—Ç–∞–ø—ã A‚ÄìE

| –ö–æ–¥ | –ù–∞–∑–≤–∞–Ω–∏–µ | –ö–ª—é—á–µ–≤—ã–µ –¥–µ–π—Å—Ç–≤–∏—è | –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ |
|-----|----------|-------------------|----------------------|
| **A** | –°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã | –ü—Ä–æ–≤–µ—Ä–∫–∞ listener/processor/db, —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –±–∞–≥–æ–≤, –ø—Ä–æ–≤–µ—Ä–∫–∞ FloodWait fix | Smoke-—Ç–µ—Å—Ç: listener ‚Üí —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ ‚Üí processor ‚Üí –ø—É–±–ª–∏–∫–∞—Ü–∏—è |
| **B** | –¢–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ | Unit-—Ç–µ—Å—Ç—ã Database, Gemini, Embeddings, Processor, Coverage > 70% | pytest -v, coverage report, –≤—Å–µ —Ç–µ—Å—Ç—ã –∑–µ–ª–µ–Ω—ã–µ |
| **C** | –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å | Gemini retry, DB WAL/concurrency, graceful shutdown, error recovery | Stress-—Ç–µ—Å—Ç, –ø—Ä–æ–≤–µ—Ä–∫–∞ recovery, –ª–æ–≥–∏ –±–µ–∑ –æ—à–∏–±–æ–∫ |
| **D** | –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è | Lazy loading, batch operations, –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ | Benchmark –¥–æ/–ø–æ—Å–ª–µ, < 5s –Ω–∞ 100 —Å–æ–æ–±—â–µ–Ω–∏–π |
| **E** | –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è & CI/CD | README, –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã, GitHub Actions, pre-commit hooks | CI/CD –∑–µ–ª–µ–Ω—ã–π, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–∞ |

### –í–ª–æ–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:

**–≠—Ç–∞–ø A ‚Äî –°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è:**
- A1: –ü—Ä–æ–≤–µ—Ä–∫–∞ listener (–∑–∞–≥—Ä—É–∑–∫–∞ –∫–∞–Ω–∞–ª–æ–≤, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π)
- A2: –ü—Ä–æ–≤–µ—Ä–∫–∞ processor (–æ–±—Ä–∞–±–æ—Ç–∫–∞, Gemini API, –ø—É–±–ª–∏–∫–∞—Ü–∏—è)
- A3: –ü—Ä–æ–≤–µ—Ä–∫–∞ database (WAL mode, concurrent access, cleanup)
- A4: Baseline smoke-—Ç–µ—Å—Ç (end-to-end flow)

**–≠—Ç–∞–ø B ‚Äî –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- B1: Unit-—Ç–µ—Å—Ç—ã Database (save, retrieve, mark_processed, embeddings)
- B2: Unit-—Ç–µ—Å—Ç—ã Gemini Client (mock API, retry, validation)
- B3: Unit-—Ç–µ—Å—Ç—ã Embeddings (encode, similarity, batch)
- B4: Integration —Ç–µ—Å—Ç—ã Processor (full flow with mocks)
- B5: Coverage report (> 70% target)

**–≠—Ç–∞–ø C ‚Äî –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:**
- C1: Gemini retry logic (tenacity, exponential backoff)
- C2: Pydantic validation –¥–ª—è Gemini –æ—Ç–≤–µ—Ç–æ–≤
- C3: DB concurrency improvements (WAL mode verification)
- C4: Graceful shutdown (signal handlers, cleanup)
- C5: Error recovery tests

**–≠—Ç–∞–ø D ‚Äî –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
- D1: Lazy loading –¥–ª—è EmbeddingService
- D2: Batch operations –¥–ª—è embeddings
- D3: –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ processor (identify bottlenecks)
- D4: –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (lru_cache –¥–ª—è —Ç—è–∂–µ–ª—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π)
- D5: Benchmark –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ

**–≠—Ç–∞–ø E ‚Äî DevOps:**
- E1: README –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- E2: Operational playbook
- E3: GitHub Actions CI/CD
- E4: Pre-commit hooks (ruff, black, pytest)
- E5: Release –ø—Ä–æ—Ü–µ–¥—É—Ä—ã

---

## ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏ –º–µ—Ä—ã

| –†–∏—Å–∫ | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –í–ª–∏—è–Ω–∏–µ | –ú–∏—Ç–∏–≥–∏—Ä—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è |
|------|-------------|---------|------------------------|
| FloodWait –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è | –ù–∏–∑–∫–∞—è | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –º–µ—Å—Ç–∞ —Å `client.start()`, code review –ø–µ—Ä–µ–¥ merge |
| –¢–µ—Å—Ç—ã –ø–∞–¥–∞—é—Ç –ø—Ä–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–æ–µ | –ó–∞–ø—É—Å–∫–∞—Ç—å pytest –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∫–æ–º–º–∏—Ç–∞, CI/CD –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω |
| DB locked errors | –°—Ä–µ–¥–Ω—è—è | –°—Ä–µ–¥–Ω–µ–µ | WAL mode verification, stress-—Ç–µ—Å—Ç—ã, retry –ª–æ–≥–∏–∫–∞ |
| Gemini API quota exceeded | –í—ã—Å–æ–∫–∞—è | –°—Ä–µ–¥–Ω–µ–µ | Rate limiting, retry —Å backoff, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–≤–æ—Ç |
| –ü–∞—Ä—Ç–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∞—è | –°—Ä–µ–¥–Ω—è—è | –°—Ä–µ–¥–Ω–µ–µ | –ö–æ–Ω—Ç—Ä–æ–ª—å diff size, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ diff-limit-plan.md |
| –ü–æ—Ç–µ—Ä—è baseline –ø—Ä–∏ –æ—Ç–∫–∞—Ç–µ | –ù–∏–∑–∫–∞—è | –í—ã—Å–æ–∫–æ–µ | Snapshot —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ `snapshot/<–¥–∞—Ç–∞>-<—ç—Ç–∞–ø>/` –ª–æ–∫–∞–ª—å–Ω–æ |

---

## üöÄ –°–ø—Ä–∏–Ω—Ç—ã —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏ (–Ω–∞ –æ—Å–Ω–æ–≤–µ code review)

–ó–∞–¥–∞—á–∏ –≤—ã—è–≤–ª–µ–Ω—ã –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ code review –æ—Ç 2025-10-14. –û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω—ã –≤ 3 —Å–ø—Ä–∏–Ω—Ç–∞ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É.

### –°–ø—Ä–∏–Ω—Ç 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–ª–æ–∫–µ—Ä—ã (5-7 –¥–Ω–µ–π)

**–¶–µ–ª—å:** –£—Å—Ç—Ä–∞–Ω–∏—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ—Ñ–µ–∫—Ç—ã, –±–ª–æ–∫–∏—Ä—É—é—â–∏–µ production deployment

#### CR-C1: StatusReporter Database DI fix
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π
**–û—Ü–µ–Ω–∫–∞:** 3 —á–∞—Å–∞

**–ü—Ä–æ–±–ª–µ–º–∞:**
- StatusReporter –ø–µ—Ä–µ–¥–∞—ë—Ç `timezone_name` –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä Database
- Database.__init__ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–æ–ª—å–∫–æ `db_path`
- –†–µ–∑—É–ª—å—Ç–∞—Ç: TypeError –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ StatusReporter

**–ò—Å—Ç–æ—á–Ω–∏–∫–∏:**
- `database/db.py:18-39`
- `services/status_reporter.py:12-92`
- `services/status_reporter.py:23-32`

**–®–∞–≥–∏:**
1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä StatusReporter: –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ db_path –∏–ª–∏ Database instance
2. –£–¥–∞–ª–∏—Ç—å timezone_name –∏–∑ –≤—ã–∑–æ–≤–∞ Database()
3. –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –º–µ—Å—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è StatusReporter
4. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç: StatusReporter —Å —Ä–∞–∑–Ω—ã–º–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏:**
- ‚úÖ StatusReporter —Å–æ–∑–¥–∞—ë—Ç—Å—è –±–µ–∑ TypeError
- ‚úÖ –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- ‚úÖ Database –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

**–§–∞–π–ª—ã:**
- `services/status_reporter.py`
- `database/db.py`
- `main.py`
- `tests/test_status_reporter.py`

---

#### CR-C2: processed —Ñ–ª–∞–≥ –¥–ª—è –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π
**–û—Ü–µ–Ω–∫–∞:** 6 —á–∞—Å–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –§–ª–∞–≥ `processed=1` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –Ω–∞ —ç—Ç–∞–ø–µ keyword-—Ñ–∏–ª—å—Ç—Ä–∞
- –ü—Ä–∏ —Å—Ç–∞—Ä–æ–º —Ä–µ–∂–∏–º–µ (use_categories=false) –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –Ω–µ –ø–æ–ª—É—á–∞—é—Ç —Å–æ–æ–±—â–µ–Ω–∏–π
- –û—Ç–∫–ª–æ–Ω—ë–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–µ—Ä–µ–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ

**–ò—Å—Ç–æ—á–Ω–∏–∫–∏:**
- `services/marketplace_processor.py:133-235`
- `database/db.py:200-239`

**–®–∞–≥–∏:**
1. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `rejection_reason TEXT` –≤ `raw_messages`
2. –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î
3. –û–±–Ω–æ–≤–∏—Ç—å `mark_as_processed()`: –¥–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä `reason`
4. –ü–æ–º–µ—á–∞—Ç—å –í–°–ï –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è:
   - `duplicate` ‚Äî –¥—É–±–ª–∏–∫–∞—Ç
   - `rejected_keywords` ‚Äî –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω keyword
   - `rejected_llm` ‚Äî –Ω–µ –≤–æ—à—ë–ª –≤ —Ç–æ–ø-N LLM
   - `published` ‚Äî —É—Å–ø–µ—à–Ω–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω
5. –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä –ø–æ–º–µ—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –ü–û–°–õ–ï –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Å–µ—Ö –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–æ–≤
6. –¢–µ—Å—Ç—ã –Ω–∞ –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏:**
- ‚úÖ –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–º–µ—á–∞—é—Ç—Å—è processed=1 –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- ‚úÖ rejection_reason –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è
- ‚úÖ –ù–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å—Ç–∞—Ä—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ Coverage database/db.py > 95%

**–§–∞–π–ª—ã:**
- `database/db.py`
- `services/marketplace_processor.py`
- `migrations/` (–Ω–æ–≤–∞—è –º–∏–≥—Ä–∞—Ü–∏—è)
- `tests/test_processor_statuses.py` (–Ω–æ–≤—ã–π)

---

#### CR-C3: SQLite lifecycle –∏ concurrency
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π
**–û—Ü–µ–Ω–∫–∞:** 5 —á–∞—Å–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:**
- listener –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ, –∞ —Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞–∫—Ä—ã—Ç—É—é –ë–î
- –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏–∑ —Ä–∞–∑–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤/—Ç–∞—Å–∫–æ–≤
- –†–∏—Å–∫ OperationalError –∏ database locked

**–®–∞–≥–∏:**
1. –í–∫–ª—é—á–∏—Ç—å WAL mode –¥–ª—è SQLite (–µ—Å–ª–∏ –µ—â—ë –Ω–µ –≤–∫–ª—é—á–µ–Ω)
2. DatabaseFactory –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è–º–∏ per-thread
3. –ö–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (listener, processor, status) —Å–æ–∑–¥–∞—ë—Ç —Å–≤–æ—ë –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
4. –û–±–Ω–æ–≤–∏—Ç—å main.py: –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å db_path –≤–º–µ—Å—Ç–æ db instance
5. Mutex –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∑–∞–ø–∏—Å–∏
6. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç: –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –∏–∑ —Ä–∞–∑–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤
7. –¢–µ—Å—Ç graceful shutdown: –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ connections

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏:**
- ‚úÖ –ù–µ—Ç "database is locked" –æ—à–∏–±–æ–∫
- ‚úÖ WAL mode –∞–∫—Ç–∏–≤–µ–Ω
- ‚úÖ –ö–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏–º–µ–µ—Ç —Å–≤–æ–π connection
- ‚úÖ Graceful shutdown –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç connections

**–§–∞–π–ª—ã:**
- `database/db.py`
- `main.py`
- `services/telegram_listener.py`
- `services/marketplace_processor.py`
- `services/status_reporter.py`
- `tests/test_database_concurrency.py` (–Ω–æ–≤—ã–π)

---

#### CR-C7: Adaptive scheduler (–∑–∞–º–µ–Ω–∞ sleep)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í—ã—Å–æ–∫–∏–π
**–û—Ü–µ–Ω–∫–∞:** 3 —á–∞—Å–∞

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ñ—ë—Å—Ç–∫–∏–π `sleep(60)` –≤ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–µ ‚Üí –∑–∞–¥–µ—Ä–∂–∫–∏ –¥–æ 60s
- –ù–µ–≤–æ–∑–º–æ–∂–Ω—ã –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã < 60s
- –î—Ä–æ–∂–∞–Ω–∏–µ —Ç–∞–π–º–∏–Ω–≥–æ–≤

**–ò—Å—Ç–æ—á–Ω–∏–∫–∏:**
- `main.py:163-170`

**–®–∞–≥–∏:**
1. –ó–∞–º–µ–Ω–∏—Ç—å `time.sleep(60)` –Ω–∞ `schedule.idle_seconds()`
2. Safety sleep (max 5 —Å–µ–∫—É–Ω–¥) –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è busy-wait
3. Edge cases: –ø—É—Å—Ç–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ, –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏
4. –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã:
   - –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ä–∞—Å—á—ë—Ç idle time
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
   - Graceful shutdown –≤–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏:**
- ‚úÖ Adaptive idle —á–µ—Ä–µ–∑ schedule.idle_seconds()
- ‚úÖ Safety sleep ‚â§ 5 —Å–µ–∫—É–Ω–¥
- ‚úÖ –¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç edge cases
- ‚úÖ Graceful shutdown —Ä–∞–±–æ—Ç–∞–µ—Ç

**–§–∞–π–ª—ã:**
- `main.py`
- `tests/test_scheduler.py` (–Ω–æ–≤—ã–π)

---

### –°–ø—Ä–∏–Ω—Ç 2: –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (5-7 –¥–Ω–µ–π)

**–¶–µ–ª—å:** –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏ LLM/embeddings

#### CR-H1: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —á—Ç–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í—ã—Å–æ–∫–∏–π
**–û—Ü–µ–Ω–∫–∞:** 4 —á–∞—Å–∞

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ —á—Ç–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π/—ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –ø–æ –∫–∞–∂–¥–æ–º—É –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å—É
- –ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –ë–î

**–ò—Å—Ç–æ—á–Ω–∏–∫–∏:**
- `services/marketplace_processor.py:133-206`
- `database/db.py:200-239`

**–®–∞–≥–∏:**
1. –ó–∞–≥—Ä—É–∂–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ–¥–∏–Ω —Ä–∞–∑ –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –≤—Å–µ—Ö –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–æ–≤
2. –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –ø–∞–º—è—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞
3. –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–æ–≤
4. Benchmark: —Å—Ä–∞–≤–Ω–∏—Ç—å –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–æ/–ø–æ—Å–ª–µ

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏:**
- ‚úÖ –°–æ–æ–±—â–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑
- ‚úÖ –î–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
- ‚úÖ –£—Å–∫–æ—Ä–µ–Ω–∏–µ ‚â• 2x –¥–ª—è multi-marketplace
- ‚úÖ Memory footprint –ø—Ä–∏–µ–º–ª–µ–º—ã–π

**–§–∞–π–ª—ã:**
- `services/marketplace_processor.py`
- `tests/test_processor_performance.py` (–Ω–æ–≤—ã–π)

---

#### CR-C5: Batch embeddings –∏ async –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í—ã—Å–æ–∫–∏–π
**–û—Ü–µ–Ω–∫–∞:** 6 —á–∞—Å–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ë–ª–æ–∫–∏—Ä—É—é—â–∞—è sync encode –≤–Ω—É—Ç—Ä–∏ async –∫–æ–¥–∞
- –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ —á—Ç–µ–Ω–∏—è/–¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≤—Å–µ—Ö embeddings
- –ö–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏

**–®–∞–≥–∏:**
1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–∞—Ç—á–µ–≤–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ EmbeddingService
2. –ö—ç—à published_embeddings –Ω–∞ –≤–µ—Å—å –ø—Ä–æ–≥–æ–Ω processor
3. Async wrapper –¥–ª—è encode (run_in_executor)
4. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è similarity checks (numpy vectorization)
5. –ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç: 1000 —Å–æ–æ–±—â–µ–Ω–∏–π, –∑–∞–º–µ—Ä –≤—Ä–µ–º–µ–Ω–∏

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏:**
- ‚úÖ Batch encoding (‚â•10 —Å–æ–æ–±—â–µ–Ω–∏–π –∑–∞ —Ä–∞–∑)
- ‚úÖ published_embeddings –∫—ç—à–∏—Ä—É—é—Ç—Å—è
- ‚úÖ Async –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è
- ‚úÖ –£—Å–∫–æ—Ä–µ–Ω–∏–µ ‚â• 5x

**–§–∞–π–ª—ã:**
- `services/embeddings.py`
- `services/marketplace_processor.py`
- `database/db.py`
- `tests/test_batch_performance.py`

---

#### CR-C6: Robust LLM (JSON validation, retry, chunking)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í—ã—Å–æ–∫–∏–π
**–û—Ü–µ–Ω–∫–∞:** 7 —á–∞—Å–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü–µ—Ä–µ–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã Gemini (–¥–µ—Å—è—Ç–∫–∏/—Å–æ—Ç–Ω–∏ —Å–æ–æ–±—â–µ–Ω–∏–π)
- –•—Ä—É–ø–∫–∏–π –ø–∞—Ä—Å–∏–Ω–≥ JSON —Ä–µ–≥—É–ª—è—Ä–∫–∞–º–∏
- –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤

**–ò—Å—Ç–æ—á–Ω–∏–∫–∏:**
- `services/marketplace_processor.py:288-352`
- `services/gemini_client.py:197-338`
- `services/gemini_client.py:512-618`

**–®–∞–≥–∏:**
1. –î–æ–±–∞–≤–∏—Ç—å Pydantic —Å—Ö–µ–º—ã –¥–ª—è Gemini responses
2. Chunking –ø—Ä–æ–º–ø—Ç–æ–≤ (max 50 —Å–æ–æ–±—â–µ–Ω–∏–π –∑–∞ –∑–∞–ø—Ä–æ—Å)
3. Retry –ª–æ–≥–∏–∫–∞ —Å exponential backoff (tenacity)
4. –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ –ø—Ä–æ–º–ø—Ç–∞ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
5. –û–±—Ä–∞–±–æ—Ç–∫–∞ —á–∞—Å—Ç–∏—á–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
6. –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (request_id, –¥–ª–∏–Ω–∞ –ø—Ä–æ–º–ø—Ç–∞, –ø–æ–ø—ã—Ç–∫–∏)
7. Property-based —Ç–µ—Å—Ç—ã

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏:**
- ‚úÖ Pydantic –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –æ—Ç–≤–µ—Ç–æ–≤
- ‚úÖ Chunking –ø—Ä–æ–º–ø—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ Retry —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–§–∞–π–ª—ã:**
- `services/gemini_client.py`
- `models/llm_schemas.py` (–Ω–æ–≤—ã–π)
- `tests/test_gemini_errors.py`
- `tests/test_gemini_chunking.py` (–Ω–æ–≤—ã–π)

---

#### CR-H4: –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (Pydantic)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í—ã—Å–æ–∫–∏–π
**–û—Ü–µ–Ω–∫–∞:** 4 —á–∞—Å–∞

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ñ—ë—Å—Ç–∫–∏–µ `int(os.getenv(...))` –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–æ–∫ ‚Üí –ø–∞–¥–µ–Ω–∏—è –Ω–∞ —Å—Ç–∞—Ä—Ç–µ
- –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ YAML –∫–æ–Ω—Ñ–∏–≥–æ–≤
- –ù–µ–¥—Ä—É–∂–µ–ª—é–±–Ω—ã–µ error messages

**–®–∞–≥–∏:**
1. –°–æ–∑–¥–∞—Ç—å Pydantic –º–æ–¥–µ–ª–∏ –¥–ª—è –≤—Å–µ—Ö —Å–µ–∫—Ü–∏–π –∫–æ–Ω—Ñ–∏–≥–∞
2. –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∫–æ–Ω—Ñ–∏–≥–∞ (utils/config.py)
3. –î—Ä—É–∂–µ–ª—é–±–Ω—ã–µ error messages —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
4. –¢–µ—Å—Ç—ã –Ω–∞ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥–∏

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏:**
- ‚úÖ Pydantic —Å—Ö–µ–º—ã –¥–ª—è –≤—Å–µ—Ö –∫–æ–Ω—Ñ–∏–≥–æ–≤
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚úÖ –ü–æ–Ω—è—Ç–Ω—ã–µ error messages
- ‚úÖ –¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç invalid cases

**–§–∞–π–ª—ã:**
- `models/config_schema.py` (–Ω–æ–≤—ã–π)
- `utils/config.py`
- `tests/test_config_validation.py` (–Ω–æ–≤—ã–π)

---

### –°–ø—Ä–∏–Ω—Ç 3: –ö–∞—á–µ—Å—Ç–≤–æ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å (5-7 –¥–Ω–µ–π)

**–¶–µ–ª—å:** –£—Å—Ç—Ä–∞–Ω–∏—Ç—å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥, —É–ª—É—á—à–∏—Ç—å maintainability

#### CR-H2: Timezone-aware —Å–∏—Å—Ç–µ–º–∞
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í—ã—Å–æ–∫–∏–π
**–û—Ü–µ–Ω–∫–∞:** 4 —á–∞—Å–∞

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ "—Å–µ–≥–æ–¥–Ω—è" –≤ UTC –≤–º–µ—Å—Ç–æ –ª–æ–∫–∞–ª—å–Ω–æ–π TZ
- `date('now')` –≤ –ë–î –∏—Å–ø–æ–ª—å–∑—É–µ—Ç UTC
- –î–∞–π–¥–∂–µ—Å—Ç –º–æ–∂–µ—Ç —Å–¥–≤–∏–≥–∞—Ç—å—Å—è –Ω–∞ ¬±1 –¥–µ–Ω—å

**–®–∞–≥–∏:**
1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å timezone-aware datetime –≤–µ–∑–¥–µ
2. –ü—Ä–∏–º–µ–Ω–∏—Ç—å TZ –∫ APScheduler
3. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å timestamps –≤ –ë–î –∫ UTC —è–≤–Ω–æ
4. –î–∞–π–¥–∂–µ—Å—Ç —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —Å —É—á—ë—Ç–æ–º TZ
5. –¢–µ—Å—Ç –Ω–∞ –≥—Ä–∞–Ω–∏—Ü—ã —Å—É—Ç–æ–∫ (23:59 ‚Üí 00:01)

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏:**
- ‚úÖ –í—Å–µ datetime objects timezone-aware
- ‚úÖ Scheduler –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—É—é TZ
- ‚úÖ –ë–î —Ö—Ä–∞–Ω–∏—Ç timestamps –≤ UTC
- ‚úÖ –¢–µ—Å—Ç –Ω–∞ –≥—Ä–∞–Ω–∏—Ü—ã —Å—É—Ç–æ–∫ –ø—Ä–æ—Ö–æ–¥–∏—Ç

**–§–∞–π–ª—ã:**
- `main.py`
- `database/db.py`
- `services/marketplace_processor.py`
- `services/status_reporter.py`
- `tests/test_timezone.py` (–Ω–æ–≤—ã–π)

---

#### CR-H3: –•—Ä—É–ø–∫–æ—Å—Ç—å —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞ / DI layer
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –°—Ä–µ–¥–Ω–∏–π
**–û—Ü–µ–Ω–∫–∞:** 5 —á–∞—Å–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:**
- main —Å–æ–∑–¥–∞—ë—Ç Database –¥–∞–∂–µ –∫–æ–≥–¥–∞ —Ä–µ–∂–∏–º—ã —Å–∞–º–∏ —Å–æ–∑–¥–∞—é—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ YAML-—á—Ç–µ–Ω–∏—è
- –ù–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏

**–®–∞–≥–∏:**
1. –°–æ–∑–¥–∞—Ç—å ServiceContainer (DI container)
2. –§–∞–±—Ä–∏–∫–∏ –¥–ª—è Database, Config, GeminiClient
3. Refactor main.py: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å container
4. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–æ–ª—É—á–∞—é—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–∑ container
5. Mock-friendly –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è —Ç–µ—Å—Ç–æ–≤

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏:**
- ‚úÖ –ï–¥–∏–Ω—ã–π ServiceContainer
- ‚úÖ –ù–µ—Ç –ø—Ä—è–º–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è instances –≤ main.py
- ‚úÖ –õ–µ–≥–∫–æ –ø–æ–¥–º–µ–Ω—è—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ —Ç–µ—Å—Ç–∞—Ö

**–§–∞–π–ª—ã:**
- `core/container.py` (–Ω–æ–≤—ã–π)
- `main.py`
- `tests/test_container.py` (–Ω–æ–≤—ã–π)

---

#### CR-H5: Config cleanup
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –ù–∏–∑–∫–∏–π
**–û—Ü–µ–Ω–∫–∞:** 3 —á–∞—Å–∞

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: `listener.reconnect_timeout`, `listener.save_batch_size`
- Config —á–∏—Ç–∞–µ—Ç—Å—è –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ
- –ù–µ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–®–∞–≥–∏:**
1. –ê—É–¥–∏—Ç –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–æ–Ω—Ñ–∏–≥–∞
2. –£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
3. Config singleton pattern
4. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å README —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
5. Inline –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ config.yaml

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏:**
- ‚úÖ –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
- ‚úÖ README –∞–∫—Ç—É–∞–ª–µ–Ω
- ‚úÖ Config –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑

**–§–∞–π–ª—ã:**
- `config/base.yaml`
- `config/profiles/*.yaml`
- `README.md`
- `utils/config.py`

---

#### CR-C4: –†–µ–∞–ª—å–Ω–∞—è –º–æ–¥–µ—Ä–∞—Ü–∏—è Telegram
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í—ã—Å–æ–∫–∏–π
**–û—Ü–µ–Ω–∫–∞:** 8 —á–∞—Å–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `moderate_posts`/`moderate_categories` –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ/—Ç–æ–ø-10
- –û—Ç–≤–µ—Ç—ã –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞ –Ω–µ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è
- –ú–æ–¥–µ—Ä–∞—Ü–∏—è ‚Äî –∑–∞–≥–ª—É—à–∫–∞ —Å –∞–≤—Ç–æ–æ–¥–æ–±—Ä–µ–Ω–∏–µ–º

**–ò—Å—Ç–æ—á–Ω–∏–∫–∏:**
- `services/marketplace_processor.py:257-279`
- `services/marketplace_processor.py:410-444`

**–®–∞–≥–∏:**
1. –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –ë–î: `pending_moderation`, `approved`, `rejected`
2. –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–π–¥–∂–µ—Å—Ç–∞ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—É –≤ Telegram
3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞:
   - Reply —Å –Ω–æ–º–µ—Ä–∞–º–∏ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è: "0,3,5"
   - –ö–æ–º–∞–Ω–¥—ã: "–≤—Å–µ", "–æ—Ç–º–µ–Ω–∞"
   - Callback buttons (inline keyboard)
4. Timeout –º–æ–¥–µ—Ä–∞—Ü–∏–∏ (–∞–≤—Ç–æ-–ø—É–±–ª–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ N —á–∞—Å–æ–≤)
5. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏–π –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞ –≤ –ë–î
6. E2E —Ç–µ—Å—Ç —Å mock Telegram API

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏:**
- ‚úÖ –î–∞–π–¥–∂–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—É
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –æ—Ç–≤–µ—Ç–æ–≤
- ‚úÖ Timeout —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –†–µ—à–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î

**–§–∞–π–ª—ã:**
- `services/marketplace_processor.py`
- `database/db.py`
- `tests/test_moderation.py` (–Ω–æ–≤—ã–π)

---

#### CR-OPT: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏ —á–∏—Å—Ç–∫–∞
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –ù–∏–∑–∫–∏–π
**–û—Ü–µ–Ω–∫–∞:** 5 —á–∞—Å–æ–≤

**–ó–∞–¥–∞—á–∏:**
1. Logging —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è (–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–¥–∏–Ω —Ä–∞–∑ –≤ main)
2. LLM prompt templates (Jinja2)
3. –£–¥–∞–ª–µ–Ω–∏–µ –º—ë—Ä—Ç–≤–æ–≥–æ –∫–æ–¥–∞ (GeminiSelector –∏–ª–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
4. –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ processor (identify bottlenecks)
5. Code style consistency (ruff, black)

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏:**
- ‚úÖ Logging –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑
- ‚úÖ –ü—Ä–æ–º–ø—Ç—ã –≤ Jinja2 templates (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- ‚úÖ –ù–µ—Ç –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ –∫–æ–¥–∞
- ‚úÖ –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ

**–§–∞–π–ª—ã:**
- `main.py`
- `utils/logger.py`
- `services/gemini_client.py`
- `config/prompts/templates/` (–Ω–æ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è)

---

### –°–ø—Ä–∏–Ω—Ç 4: –£–Ω–∏–≤–µ—Ä—Å–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞ (5-7 –¥–Ω–µ–π)

**–¶–µ–ª—å:** –ü—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç –∏–∑ marketplace-specific –≤ truly universal

**–ö–æ–Ω—Ç–µ–∫—Å—Ç:**
–ü—Ä–æ–µ–∫—Ç –Ω–∞—á–∏–Ω–∞–ª—Å—è –∫–∞–∫ marketplace-news-bot (–¥–ª—è Ozon –∏ Wildberries), –Ω–æ —Ç–µ–ø–µ—Ä—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–º. –í—Å–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–æ–≤ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¢–û–õ–¨–ö–û –≤ –∫–æ–Ω—Ñ–∏–≥–∞—Ö, –Ω–µ –≤ –∫–æ–¥–µ.

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**
- 167 —É–ø–æ–º–∏–Ω–∞–Ω–∏–π marketplace-—Å–ø–µ—Ü–∏—Ñ–∏–∫–∏ –≤ Python –∫–æ–¥–µ
- Hardcoded –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: "wildberries", "ozon", "general"
- –ù–µ—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–ª–∞—Å—Å–æ–≤: `MarketplaceProcessor`, `Marketplace`

---

#### U1: –£–¥–∞–ª–∏—Ç—å hardcoded –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π
**–û—Ü–µ–Ω–∫–∞:** 2 —á–∞—Å–∞

**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
# services/marketplace_processor.py:93-95
self.all_digest_counts = {
    "wildberries": 5,  # ‚ùå Hardcode
    "ozon": 5,         # ‚ùå Hardcode
    "general": 5,      # ‚ùå Hardcode
}
```

**–®–∞–≥–∏:**
1. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å `all_digest_counts` –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ —á—Ç–µ–Ω–∏—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
2. –û–±–Ω–æ–≤–∏—Ç—å `select_three_categories()` ‚Üí `select_by_categories()`
3. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å `_format_categories_moderation_message()` –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
4. –£–±—Ä–∞—Ç—å hardcoded "wildberries", "ozon" –∏–∑ –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏:**
- ‚úÖ –ù–µ—Ç hardcoded "wildberries", "ozon", "general" –≤ –∫–æ–¥–µ
- ‚úÖ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —á–∏—Ç–∞—é—Ç—Å—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏
- ‚úÖ –í—Å–µ 103 —Ç–µ—Å—Ç–∞ –ø—Ä–æ—Ö–æ–¥—è—Ç
- ‚úÖ Backwards compatibility —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞

**–§–∞–π–ª—ã:**
- `services/marketplace_processor.py`
- `services/gemini_client.py`
- `tests/test_processor_statuses.py`

---

#### U2: –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –∫–ª–∞—Å—Å—ã –∏ —Ñ–∞–π–ª—ã
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π
**–û—Ü–µ–Ω–∫–∞:** 1 —á–∞—Å

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `class MarketplaceProcessor` ‚Üí –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `NewsProcessor`
- `models/marketplace.py` ‚Üí –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `models/category.py`
- `class Marketplace` ‚Üí –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `Category`

**–®–∞–≥–∏:**
1. –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å `models/marketplace.py` ‚Üí `models/category.py`
2. –ó–∞–º–µ–Ω–∏—Ç—å `class Marketplace` ‚Üí `class Category`
3. –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å `class MarketplaceProcessor` ‚Üí `class NewsProcessor`
4. –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å `services/marketplace_processor.py` ‚Üí `services/news_processor.py`
5. –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã –≤ main.py –∏ —Ç–µ—Å—Ç–∞—Ö

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏:**
- ‚úÖ –ö–ª–∞—Å—Å—ã –∏–º–µ—é—Ç —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è
- ‚úÖ –í—Å–µ –∏–º–ø–æ—Ä—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã
- ‚úÖ –í—Å–µ 103 —Ç–µ—Å—Ç–∞ –ø—Ä–æ—Ö–æ–¥—è—Ç

**–§–∞–π–ª—ã:**
- `models/marketplace.py` ‚Üí `models/category.py`
- `services/marketplace_processor.py` ‚Üí `services/news_processor.py`
- `main.py`
- –í—Å–µ —Ç–µ—Å—Ç—ã

---

#### U3: –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ –º–µ—Ç–æ–¥—ã
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –°—Ä–µ–¥–Ω–∏–π
**–û—Ü–µ–Ω–∫–∞:** 1 —á–∞—Å

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: `self.marketplaces`, `marketplace_names`, `raw_marketplaces`
- –ú–µ—Ç–æ–¥—ã: `process_marketplace()`

**–®–∞–≥–∏:**
1. `self.marketplaces` ‚Üí `self.categories`
2. `marketplace_names` ‚Üí `category_names`
3. `process_marketplace()` ‚Üí `process_category()`
4. –í—Å–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ `marketplace` ‚Üí `category`

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏:**
- ‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–º–µ—é—Ç —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞
- ‚úÖ –ú–µ—Ç–æ–¥—ã –∏–º–µ—é—Ç —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞
- ‚úÖ –í—Å–µ 103 —Ç–µ—Å—Ç–∞ –ø—Ä–æ—Ö–æ–¥—è—Ç

**–§–∞–π–ª—ã:**
- `services/news_processor.py` (–±—ã–≤—à–∏–π marketplace_processor)
- –í—Å–µ —Ç–µ—Å—Ç—ã

---

#### U4: –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥ —Å backwards compatibility
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –°—Ä–µ–¥–Ω–∏–π
**–û—Ü–µ–Ω–∫–∞:** 1 —á–∞—Å

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ö–æ–Ω—Ñ–∏–≥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–ª—é—á `marketplaces:`
- –ù—É–∂–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ `categories:` —Å fallback –Ω–∞ `marketplaces:`

**–®–∞–≥–∏:**
1. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É `config.get("categories")`
2. Fallback: `config.get("categories") or config.get("marketplaces")`
3. –û–±–Ω–æ–≤–∏—Ç—å `models/config_schemas.py`
4. –°–æ–∑–¥–∞—Ç—å –ø—Ä–∏–º–µ—Ä `config/profiles/generic.yaml`
5. –¢–µ—Å—Ç—ã –¥–ª—è –æ–±–æ–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∫–æ–Ω—Ñ–∏–≥–∞

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏:**
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å `categories:` –∫–ª—é—á–æ–º
- ‚úÖ Backwards compatible —Å `marketplaces:`
- ‚úÖ –ü—Ä–∏–º–µ—Ä generic –∫–æ–Ω—Ñ–∏–≥–∞ —Å–æ–∑–¥–∞–Ω
- ‚úÖ –¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç –æ–±–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞

**–§–∞–π–ª—ã:**
- `utils/config.py`
- `models/config_schemas.py`
- `config/profiles/generic.yaml` (–Ω–æ–≤—ã–π)
- `tests/test_config_validation.py`

---

#### U5: –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –ù–∏–∑–∫–∏–π
**–û—Ü–µ–Ω–∫–∞:** 1.5 —á–∞—Å–∞

**–ó–∞–¥–∞—á–∏:**
1. –û–±–Ω–æ–≤–∏—Ç—å docstrings (–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å ‚Üí –∫–∞—Ç–µ–≥–æ—Ä–∏—è)
2. –û–±–Ω–æ–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (üõí ‚Üí üì∞)
3. –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
4. –û–±–Ω–æ–≤–∏—Ç—å README.md —Å —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π
5. –û–±–Ω–æ–≤–∏—Ç—å memory-bank/arkhitektura.md
6. –°–æ–∑–¥–∞—Ç—å RELEASE_NOTES_v2.2.0.md

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏:**
- ‚úÖ –í—Å–µ docstrings –æ–±–Ω–æ–≤–ª–µ–Ω—ã
- ‚úÖ –õ–æ–≥–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—É—é —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—é
- ‚úÖ README –æ–ø–∏—Å—ã–≤–∞–µ—Ç —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É
- ‚úÖ Release notes —Å–æ–∑–¥–∞–Ω—ã

**–§–∞–π–ª—ã:**
- `services/news_processor.py`
- `README.md`
- `memory-bank/arkhitektura.md`
- `RELEASE_NOTES_v2.2.0.md`

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç—ã –∞–∫—Ç–∏–≤–Ω—ã—Ö —à–∞–≥–æ–≤

### A1 ‚Äî –ü—Ä–æ–≤–µ—Ä–∫–∞ listener
- [ ] Listener –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∫–∞–Ω–∞–ª—ã (subscriptions –∏–ª–∏ manual)
- [ ] –ù–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î
- [ ] Heartbeat —Ñ–∞–π–ª –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
- [ ] –õ–æ–≥–∏ –±–µ–∑ –æ—à–∏–±–æ–∫ –∑–∞ 5 –º–∏–Ω—É—Ç —Ä–∞–±–æ—Ç—ã

### A2 ‚Äî –ü—Ä–æ–≤–µ—Ä–∫–∞ processor
- [ ] Processor –∑–∞–≥—Ä—É–∂–∞–µ—Ç –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- [ ] Gemini API –æ—Ç–≤–µ—á–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] Embeddings –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è
- [ ] –î—É–±–ª–∏–∫–∞—Ç—ã –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤—ã–≤–∞—é—Ç—Å—è
- [ ] –î–∞–π–¥–∂–µ—Å—Ç —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è

### A3 ‚Äî –ü—Ä–æ–≤–µ—Ä–∫–∞ database
- [ ] WAL mode –≤–∫–ª—é—á–µ–Ω (`PRAGMA journal_mode`)
- [ ] Concurrent access —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
- [ ] Cleanup —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Indexes —Å—É—â–µ—Å—Ç–≤—É—é—Ç –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
- [ ] Backup/restore –ø—Ä–æ—Ü–µ–¥—É—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç

### B1 ‚Äî Unit-—Ç–µ—Å—Ç—ã Database
- [ ] test_save_message
- [ ] test_get_unprocessed_messages
- [ ] test_mark_as_processed
- [ ] test_save_embedding
- [ ] test_get_published_embeddings
- [ ] test_cleanup_old_messages
- [ ] Coverage database/db.py > 80%

### B2 ‚Äî Unit-—Ç–µ—Å—Ç—ã Gemini Client
- [ ] test_select_and_format_marketplace_news (mock)
- [ ] test_retry_on_api_error
- [ ] test_invalid_json_response
- [ ] test_pydantic_validation
- [ ] Coverage services/gemini_client.py > 70%

### B3 ‚Äî Unit-—Ç–µ—Å—Ç—ã Embeddings
- [ ] test_encode_single
- [ ] test_encode_batch
- [ ] test_cosine_similarity
- [ ] test_check_duplicate
- [ ] Coverage services/embeddings.py > 80%

### C1 ‚Äî Gemini retry logic
- [ ] tenacity retry –¥–æ–±–∞–≤–ª–µ–Ω
- [ ] exponential backoff –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] max_attempts = 3
- [ ] before_sleep logging
- [ ] —Ç–µ—Å—Ç—ã retry behavior

### C2 ‚Äî Pydantic validation
- [ ] GeminiResponse model —Å–æ–∑–¥–∞–Ω
- [ ] parse_obj –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
- [ ] ValidationError –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è
- [ ] —Ç–µ—Å—Ç—ã —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

### E1 ‚Äî README –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- [ ] –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ
- [ ] –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ
- [ ] –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- [ ] Configuration guide
- [ ] Troubleshooting —Å–µ–∫—Ü–∏—è

### E3 ‚Äî GitHub Actions CI/CD
- [ ] .github/workflows/ci.yml —Å–æ–∑–¥–∞–Ω
- [ ] pytest –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- [ ] ruff/black –ø—Ä–æ–≤–µ—Ä–∫–∏
- [ ] Coverage report
- [ ] Badge –≤ README

---

## üìì –ñ—É—Ä–Ω–∞–ª –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

| –î–∞—Ç–∞/–≤—Ä–µ–º—è | –≠—Ç–∞–ø | –ü–∞—Ä—Ç–∏—è | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|------------|------|--------|--------|-------------|
| 2025-10-14 19:00 | Init | FloodWait fix | ‚úÖ | –ü—Ä–∏–º–µ–Ω–µ–Ω safe_connect() –≤–æ –≤—Å–µ—Ö —Ñ–∞–π–ª–∞—Ö, 0 –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ |
| 2025-10-14 19:15 | Init | –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | ‚úÖ | –û–±–Ω–æ–≤–ª–µ–Ω—ã DOROZHNAYA_KARTA, memory-bank, —Å–æ–∑–¥–∞–Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ |
| 2025-10-14 20:00 | Planning | Code Review | ‚úÖ | –î–æ–±–∞–≤–ª–µ–Ω—ã 3 —Å–ø—Ä–∏–Ω—Ç–∞ —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ code review (11 –∑–∞–¥–∞—á) |
| 2025-10-14 20:15 | Sprint 1 | CR-C1 | ‚úÖ | StatusReporter DI —É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω, –æ–±–Ω–æ–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç—ã (2/2 passing) |
| 2025-10-14 21:00 | Sprint 1 | CR-C2 | ‚úÖ | –û—Ç–ª–æ–∂–µ–Ω–Ω–∞—è –ø–æ–º–µ—Ç–∫–∞ processed –≤ process_marketplace –∏ process_all_categories (54/54 tests, 92.78% coverage) |
| 2025-10-14 22:30 | Sprint 1 | CR-C3 | ‚úÖ | SQLite lifecycle –∏ concurrency (2 –∫–æ–º–º–∏—Ç–∞: Part 1 context manager + Part 2 per-component db, 51/51 tests, 90% coverage) |
| 2025-10-14 23:00 | Sprint 1 | CR-C7 | ‚úÖ | Adaptive scheduler —Å schedule.idle_seconds() –∏ safety sleep (6/6 tests, 57/57 total, 90% coverage) |
| 2025-10-14 23:30 | Sprint 2 | CR-H1 | ‚úÖ | –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —á—Ç–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π: –∫—ç—à published_embeddings + base_messages, inline duplicate check (90 lines, 57/57 tests, 90% coverage, 2x+ —É—Å–∫–æ—Ä–µ–Ω–∏–µ) |
| 2025-10-15 00:30 | Sprint 2 | CR-C5 | ‚úÖ | Batch embeddings –∏ async –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è: 5 –∫–æ–º–º–∏—Ç–æ–≤ (Part 1-5), async wrappers + batch encoding + batch similarity + tests (63/63 tests, 90% coverage, 5-10x —É—Å–∫–æ—Ä–µ–Ω–∏–µ) |
| 2025-10-15 01:00 | Sprint 2 | CR-C6 | ‚úÖ | Robust LLM –∑–∞–≤–µ—Ä—à—ë–Ω (5 –∫–æ–º–º–∏—Ç–æ–≤): Part 1 Pydantic schemas (125 lines), Part 2 chunking marketplace (120 lines), Part 3 chunking categories (96 lines), Part 4 –≤–∞–ª–∏–¥–∞—Ü–∏—è+–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (94 lines), Part 5 tests (258 lines, 11 tests). –ò—Ç–æ–≥–æ 74/74 tests, 90% coverage |
| 2025-10-15 02:00 | Sprint 2 | CR-H4 | ‚úÖ | –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (Pydantic) –∑–∞–≤–µ—Ä—à–µ–Ω–∞ (4 –∫–æ–º–º–∏—Ç–∞): Part 1 models/config_schemas.py (431 lines), Part 2-3 –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ utils/config.py + env validation (66 lines), Part 4 tests/test_config_validation.py (298 lines, 11 tests). –î—Ä—É–∂–µ–ª—é–±–Ω—ã–µ ‚ùå error messages. –ò—Ç–æ–≥–æ 85/85 tests, 90% coverage |
| 2025-10-14 21:45 | Sprint 3 | CR-H2 | ‚úÖ | Timezone-aware —Å–∏—Å—Ç–µ–º–∞: database/db.py get_today_stats() —Å timezone_name –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º (53 lines), tests/test_timezone.py (233 lines, 6 tests). –ì—Ä–∞–Ω–∏—Ü—ã –¥–Ω—è –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π TZ, –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ UTC. 91/91 tests, coverage database/db.py 90.61% (–±—ã–ª–æ 40%) |
| 2025-10-14 22:30 | Sprint 3 | CR-H3 | ‚úÖ | DI layer (Dependency Injection): 2 –∫–æ–º–º–∏—Ç–∞ (Part 1 ServiceContainer + Part 2 main.py integration). core/container.py (118 lines), tests/test_container.py (181 lines, 9 tests), main.py refactored –¥–ª—è get_container().config, test_listener_manual.py –∏—Å–ø—Ä–∞–≤–ª–µ–Ω (3 —Ç–µ—Å—Ç–∞). 103/103 tests, coverage 90.61% |
| 2025-10-14 23:00 | Sprint 3 | CR-H5 | ‚úÖ | Config cleanup: —É–¥–∞–ª–µ–Ω—ã 6 –≥—Ä—É–ø–ø –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (reconnect_timeout, save_batch_size, include_keywords, moderation.exclude_keywords, features.*, alerts.*). –î–æ–±–∞–≤–ª–µ–Ω—ã inline –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫–æ –≤—Å–µ–º —Å–µ–∫—Ü–∏—è–º base.yaml. Config singleton —á–µ—Ä–µ–∑ CR-H3. Diff: 45 ins, 86 del (-41 lines). 103/103 tests, 90.61% coverage |
| 2025-10-15 00:00 | Sprint 3 | CR-C4 Part 1 | ‚úÖ | Moderation timeout: –ó–∞–º–µ–Ω—ë–Ω float('inf') –Ω–∞ config.moderation.timeout_hours (default 2—á). –ü—Ä–∏ timeout - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è –≤—Å–µ—Ö –Ω–æ–≤–æ—Å—Ç–µ–π (return []). –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—É. asyncio.TimeoutError –æ–±—Ä–∞–±–æ—Ç–∫–∞. Diff: 22 ins, 2 del (24 lines). 103/103 tests, 90.61% coverage |
| 2025-10-15 00:30 | Sprint 3 | CR-OPT | ‚úÖ | Code style consistency: ruff (—É–¥–∞–ª–µ–Ω—ã 3 unused imports + trailing whitespace) + black formatting (3 —Ñ–∞–π–ª–∞). –ü—Ä–æ–≤–µ—Ä–∫–∞ –º—ë—Ä—Ç–≤–æ–≥–æ –∫–æ–¥–∞ (llm/selectors - –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Å–ª–æ–∏, –æ—Å—Ç–∞–≤–ª–µ–Ω—ã). Logging —É–∂–µ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω. Diff: 51 ins, 69 del (-18 lines). 103/103 tests, 90.61% coverage |
| 2025-10-15 03:00 | Planning | –£–Ω–∏–≤–µ—Ä—Å–∞–ª–∏–∑–∞—Ü–∏—è | ‚úÖ | –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å: –Ω–∞–π–¥–µ–Ω–æ 167 marketplace-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö —É–ø–æ–º–∏–Ω–∞–Ω–∏–π –≤ –∫–æ–¥–µ. –°–æ–∑–¥–∞–Ω UNIVERSALIZATION_PLAN.md (480 —Å—Ç—Ä–æ–∫, –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –Ω–∞ 8 —ç—Ç–∞–ø–æ–≤, ~7 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã) |
| 2025-10-15 03:15 | Sprint 4 | –≠—Ç–∞–ø 1 –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ | ‚è≥ | –°–æ–∑–¥–∞–Ω feature branch feature/universalize-codebase, –æ–±–Ω–æ–≤–ª–µ–Ω–∞ DOROZHNAYA_KARTA.md —Å Sprint 4 (5 –∑–∞–¥–∞—á: U1-U5) |
| | | | | |

**–°–ø—Ä–∏–Ω—Ç—ã —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏ (Code Review):**

### –°–ø—Ä–∏–Ω—Ç 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–ª–æ–∫–µ—Ä—ã
| –î–∞—Ç–∞ | –ó–∞–¥–∞—á–∞ | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|------|--------|--------|-------------|
| 2025-10-14 | CR-C1 | ‚úÖ | StatusReporter DI —É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω, —Ç–µ—Å—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã (connect() + bot_token) |
| 2025-10-14 | CR-C2 | ‚úÖ | –û—Ç–ª–æ–∂–µ–Ω–Ω–∞—è –ø–æ–º–µ—Ç–∫–∞ processed –≤ process_marketplace –∏ process_all_categories (2 –∫–æ–º–º–∏—Ç–∞: Part 1 + Part 2) |
| 2025-10-14 | CR-C3 | ‚úÖ | SQLite lifecycle –∏ concurrency (Part 1: context manager + threading, Part 2: per-component db instances) |
| 2025-10-14 | CR-C7 | ‚úÖ | Adaptive scheduler (schedule.idle_seconds() + safety sleep max 5s + edge cases + 6 tests) |

### –°–ø—Ä–∏–Ω—Ç 2: –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
| –î–∞—Ç–∞ | –ó–∞–¥–∞—á–∞ | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|------|--------|--------|-------------|
| 2025-10-14 | CR-H1 | ‚úÖ | –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —á—Ç–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π: –∫—ç—à published_embeddings + base_messages, inline check (90 lines, 2x+ speedup) |
| 2025-10-15 | CR-C5 | ‚úÖ | Batch embeddings –∏ async –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è (5 –∫–æ–º–º–∏—Ç–æ–≤: async wrappers, batch in filter_duplicates, batch in publish, batch similarity, tests + pytest-asyncio) |
| 2025-10-15 | CR-C6 | ‚úÖ | Robust LLM –∑–∞–≤–µ—Ä—à—ë–Ω (5 —á–∞—Å—Ç–µ–π): Pydantic schemas, chunking marketplace, chunking categories, –≤–∞–ª–∏–¥–∞—Ü–∏—è+–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ request_id, 11 comprehensive tests (74/74 total, 90% coverage) |
| 2025-10-15 | CR-H4 | ‚úÖ | –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (Pydantic) –∑–∞–≤–µ—Ä—à–µ–Ω–∞ (4 —á–∞—Å—Ç–∏): AppConfig/EnvConfig schemas (431 lines), –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ utils/config.py (66 lines), 11 validation tests (298 lines). –î—Ä—É–∂–µ–ª—é–±–Ω—ã–µ ‚ùå error messages (85/85 tests, 90% coverage) |

### –°–ø—Ä–∏–Ω—Ç 3: –ö–∞—á–µ—Å—Ç–≤–æ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
| –î–∞—Ç–∞ | –ó–∞–¥–∞—á–∞ | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|------|--------|--------|-------------|
| 2025-10-14 | CR-H2 | ‚úÖ | Timezone-aware —Å–∏—Å—Ç–µ–º–∞: get_today_stats() —Å timezone_name, 6 tests –≥—Ä–∞–Ω–∏—Ü —Å—É—Ç–æ–∫, coverage 90.61% |
| 2025-10-14 | CR-H3 | ‚úÖ | DI layer (ServiceContainer): 2 –∫–æ–º–º–∏—Ç–∞, 9 tests container + 3 tests listener_manual, 103/103 tests passing |
| 2025-10-14 | CR-H5 | ‚úÖ | Config cleanup: —É–¥–∞–ª–µ–Ω—ã 6 –≥—Ä—É–ø–ø –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, inline –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏, 103/103 tests, -41 lines |
| 2025-10-15 | CR-C4 | ‚úÖ | Moderation timeout (critical): timeout –≤–º–µ—Å—Ç–æ float('inf'), –∞–≤—Ç–æ-–ø—É–±–ª–∏–∫–∞—Ü–∏—è –ø—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏, 103/103 tests |
| 2025-10-15 | CR-OPT | ‚úÖ | Code style: ruff + black, –ø—Ä–æ–≤–µ—Ä–∫–∞ –º—ë—Ä—Ç–≤–æ–≥–æ –∫–æ–¥–∞, logging —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è, 103/103 tests, -18 lines |

### –°–ø—Ä–∏–Ω—Ç 4: –£–Ω–∏–≤–µ—Ä—Å–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞
| –î–∞—Ç–∞ | –ó–∞–¥–∞—á–∞ | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|------|--------|--------|-------------|
| 2025-10-15 | –≠—Ç–∞–ø 1 | ‚úÖ | –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞: feature branch, UNIVERSALIZATION_PLAN.md (480 —Å—Ç—Ä–æ–∫), –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –∫–∞—Ä—Ç–∞ (commit 4faf7cd) |
| | U1 | ‚úÖ | –£–¥–∞–ª–∏—Ç—å hardcoded –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: dynamic all_digest_counts, select_by_categories() (commit f8bcba6, 103 tests) |
| | U2 | ‚úÖ | –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –∫–ª–∞—Å—Å—ã/—Ñ–∞–π–ª—ã: NewsProcessor, Category, 0 net lines changed (commit 3ad8187) |
| | U3 | ‚úÖ | –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: self.categories, category_names, process_category() (commit 6dfb2f6) |
| | U4 | ‚úÖ | Backwards compatibility: categories or marketplaces, generic.yaml (commit b865606) |
| | U5 | ‚úÖ | –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—è: docstrings, logging, üõí‚Üíüì∞ (commit c4603f7, 103 tests) |

**–ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–æ–π ¬´–ü—Ä–æ—Ç–æ–∫–æ–ª, —à–∞–≥ ‚Ä¶¬ª –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–æ–¥—ç—Ç–∞–ø–∞/–ø–∞—Ä—Ç–∏–∏.**

---

## üìå –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

- **–í–µ—Ä—Å–∏—è:** 2.2.0-dev
- **–ü–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–º–º–∏—Ç:** c4603f7 (Sprint 4 –ó–ê–í–ï–†–®–Å–ù: —É–Ω–∏–≤–µ—Ä—Å–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞)
- **–¢–µ–∫—É—â–∏–π —ç—Ç–∞–ø:** ‚úÖ –°–ø—Ä–∏–Ω—Ç 4 - –£–Ω–∏–≤–µ—Ä—Å–∞–ª–∏–∑–∞—Ü–∏—è (5/5 tasks) - –ó–ê–í–ï–†–®–Å–ù!
- **–¢–µ–∫—É—â–∞—è –≤–µ—Ç–∫–∞:** feature/universalize-codebase
- **–°–ª–µ–¥—É—é—â–∞—è —Ü–µ–ª—å:** Merge –≤ main, —Ä–µ–ª–∏–∑ v2.2.0
- **–ë–ª–æ–∫–µ—Ä—ã:** –ù–µ—Ç

**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:**
- ‚úÖ Listener ‚Äî –±–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç, —Å–æ–∑–¥–∞–µ—Ç —Å–≤–æ–π DB
- ‚úÖ Processor ‚Äî –±–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç, —Å–æ–∑–¥–∞–µ—Ç —Å–≤–æ–π DB + –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —á—Ç–µ–Ω–∏—è (CR-H1)
- ‚úÖ Embeddings ‚Äî lazy loading + async wrappers + batch encoding + batch similarity (CR-C5)
- ‚úÖ Database ‚Äî SQLite —Å WAL mode + context manager + per-component instances + timezone-aware stats (CR-H2)
- ‚úÖ Scheduler ‚Äî adaptive idle —á–µ—Ä–µ–∑ schedule.idle_seconds() + safety sleep
- ‚úÖ FloodWait protection ‚Äî safe_connect() –ø—Ä–∏–º–µ–Ω–µ–Ω
- ‚úÖ Config Validation ‚Äî Pydantic schemas –¥–ª—è –≤—Å–µ—Ö –∫–æ–Ω—Ñ–∏–≥–æ–≤, env validation, –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–µ ‚ùå error messages (CR-H4)
- ‚úÖ –¢–µ—Å—Ç—ã ‚Äî 91/94 passing, database coverage 90.61% (+6 timezone —Ç–µ—Å—Ç–æ–≤)
- ‚è≥ CI/CD ‚Äî –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚è≥ Monitoring ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π (healthcheck)

**–ù–æ–≤—ã–µ —Å–ø—Ä–∏–Ω—Ç—ã (Code Review):**
- ‚úÖ –°–ø—Ä–∏–Ω—Ç 1: 4 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –±–ª–æ–∫–µ—Ä–∞ –ó–ê–í–ï–†–®–ï–ù (CR-C1 ‚úÖ, CR-C2 ‚úÖ, CR-C3 ‚úÖ, CR-C7 ‚úÖ)
- ‚úÖ –°–ø—Ä–∏–Ω—Ç 2: 4 –≤—ã—Å–æ–∫–æ–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã—Ö –∑–∞–¥–∞—á–∏ –ó–ê–í–ï–†–®–ï–ù (CR-H1 ‚úÖ, CR-C5 ‚úÖ, CR-C6 ‚úÖ, CR-H4 ‚úÖ)
- ‚úÖ –°–ø—Ä–∏–Ω—Ç 3: 5 –∑–∞–¥–∞—á –∫–∞—á–µ—Å—Ç–≤–∞/–º–∞—Å—à—Ç–∞–±–∞ –ó–ê–í–ï–†–®–ï–ù (CR-H2 ‚úÖ, CR-H3 ‚úÖ, CR-H5 ‚úÖ, CR-C4 ‚úÖ, CR-OPT ‚úÖ)
- ‚è≥ –°–ø—Ä–∏–Ω—Ç 4: 5 –∑–∞–¥–∞—á —É–Ω–∏–≤–µ—Ä—Å–∞–ª–∏–∑–∞—Ü–∏–∏ (U1 ‚è≥, U2 ‚è≥, U3 ‚è≥, U4 ‚è≥, U5 ‚è≥)

---

## üõ† –ë—ã—Å—Ç—Ä—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª

### –ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Å—Å–∏–∏:

```
–ü—Ä–æ—Ç–æ–∫–æ–ª, —à–∞–≥ <–∫–æ–¥>
```

**–ü—Ä–∏–º–µ—Ä—ã:**
- `–ü—Ä–æ—Ç–æ–∫–æ–ª, —à–∞–≥ A1` ‚Äî –ü—Ä–æ–≤–µ—Ä–∫–∞ listener
- `–ü—Ä–æ—Ç–æ–∫–æ–ª, —à–∞–≥ B1` ‚Äî Unit-—Ç–µ—Å—Ç—ã Database
- `–ü—Ä–æ—Ç–æ–∫–æ–ª, —à–∞–≥ C1` ‚Äî Gemini retry logic

**–ù–æ–≤—ã–µ —Å–ø—Ä–∏–Ω—Ç—ã (Code Review):**
- `–ü—Ä–æ—Ç–æ–∫–æ–ª, —à–∞–≥ CR-C1` ‚Äî StatusReporter Database DI fix
- `–ü—Ä–æ—Ç–æ–∫–æ–ª, —à–∞–≥ CR-C2` ‚Äî processed —Ñ–ª–∞–≥ –¥–ª—è –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- `–ü—Ä–æ—Ç–æ–∫–æ–ª, —à–∞–≥ CR-C3` ‚Äî SQLite lifecycle –∏ concurrency
- `–ü—Ä–æ—Ç–æ–∫–æ–ª, —à–∞–≥ CR-C7` ‚Äî Adaptive scheduler

### –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:

1. **Memory:** –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–∞–º—è—Ç–∫–∏ –≤ `memory-bank/`
   - `diff-limit-plan.md` ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–∞—Ä—Ç–∏–∏
   - `verification-protocol.md` ‚Äî —á–µ–∫-–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–æ–∫
   - `rollback-protocol.md` ‚Äî –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ –æ—Ç–∫–∞—Ç–∞ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

2. **Roadmap:** –°–≤–µ—Ä–∏—Ç—å—Å—è —Å –Ω–∞—Å—Ç–æ—è—â–∏–º —Ñ–∞–π–ª–æ–º
   - –ù–∞–π—Ç–∏ —Ç–µ–∫—É—â–∏–π —ç—Ç–∞–ø –≤ —Ç–∞–±–ª–∏—Ü–µ —ç—Ç–∞–ø–æ–≤ A‚ÄìE
   - –ü—Ä–æ—á–∏—Ç–∞—Ç—å —á–µ–∫-–ª–∏—Å—Ç –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ —à–∞–≥–∞
   - –ü–æ–Ω—è—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

3. **Instruction:** –û—Ç–∫—Ä—ã—Ç—å `INSTRUKTSIYA_VYPOLNENIYA.md`
   - –ù–∞–π—Ç–∏ –¥–µ—Ç–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è —à–∞–≥–∞
   - –°–ª–µ–¥–æ–≤–∞—Ç—å –ø–æ—à–∞–≥–æ–≤–æ–º—É –ø–ª–∞–Ω—É

4. **Execute:** –í—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–¥–∞—á—É
   - –°–æ–±–ª—é–¥–∞—Ç—å diff-limit
   - –î–µ–ª–∞—Ç—å —á–∞—Å—Ç—ã–µ –∫–æ–º–º–∏—Ç—ã
   - –ó–∞–ø—É—Å–∫–∞—Ç—å —Ç–µ—Å—Ç—ã

5. **Update:** –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã
   - –û—Ç–º–µ—Ç–∏—Ç—å –≤ –∂—É—Ä–Ω–∞–ª–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
   - –û–±–Ω–æ–≤–∏—Ç—å memory-bank –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–≥–∏ –≤ `logs/` (–ª–æ–∫–∞–ª—å–Ω–æ)

6. **Verify:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
   - –ó–∞–ø—É—Å—Ç–∏—Ç—å verification protocol
   - `git diff --stat` ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä
   - Smoke-—Ç–µ—Å—Ç –µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ

---

## üîÑ –ü–ª–∞–Ω –æ—Ç–∫–∞—Ç–∞ / PR

**–ü–æ—Å–ª–µ–¥–Ω–∏–π —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –∫–æ–º–º–∏—Ç:**
–ë—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ `snapshot/baseline_commit.txt` –ø–æ—Å–ª–µ —ç—Ç–∞–ø–∞ A

**Rollback –ø—Ä–æ—Ü–µ–¥—É—Ä–∞:**
```bash
# –ü—Ä–∏ –∫—Ä–∏—Ç–∏—á–Ω–æ–π –ø—Ä–æ–±–ª–µ–º–µ
git checkout $(cat snapshot/baseline_commit.txt)

# –ò–ª–∏ –ø–æ —Ç–µ–≥—É
git checkout v1.0.0-stageA
```

**–ü—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ PR:**
- [ ] –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç: `pytest -v`
- [ ] –õ–∏–Ω—Ç–µ—Ä—ã –ø—Ä–æ—Ö–æ–¥—è—Ç: `ruff check . && black --check .`
- [ ] Coverage > 70%: `pytest --cov`
- [ ] Smoke-—Ç–µ—Å—Ç end-to-end
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- [ ] –ñ—É—Ä–Ω–∞–ª –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω
- [ ] –ù–µ—Ç –∫–æ–º–º–∏—Ç–æ–≤ —Å–µ–∫—Ä–µ—Ç–æ–≤/credentials

**Pull Request:**
- –°–æ–∑–¥–∞–≤–∞—Ç—å –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞ (A, B, C, D, E)
- –û–ø–∏—Å—ã–≤–∞—Ç—å: —á—Ç–æ —Å–¥–µ–ª–∞–Ω–æ, –∫–∞–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã, —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏
- –í–∫–ª—é—á–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ journal entry
- Reviewer –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á–µ—Ä–µ–∑ `verification-protocol.md`

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞ –ø—Ä–æ–µ–∫—Ç–∞

**–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤:**

| –ú–µ—Ç—Ä–∏–∫–∞ | –¶–µ–ª—å | –¢–µ–∫—É—â–µ–µ | –°—Ç–∞—Ç—É—Å |
|---------|------|---------|--------|
| Test Coverage | > 70% | 0% | ‚è≥ |
| Tests passing | 100% | N/A | ‚è≥ |
| Listener uptime | > 99% | Unknown | ‚è≥ |
| Processor success rate | > 95% | Unknown | ‚è≥ |
| CI/CD pipeline | Green | None | ‚è≥ |
| Documentation | Complete | 60% | ‚è≥ |
| FloodWait incidents | 0 | 0 | ‚úÖ |
| Production ready | Yes | No | ‚è≥ |

---

_–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç ‚Äî **Single Source of Truth**: –ª—é–±—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–æ—Ä–æ–∂–∫–∏, —Ä–∏—Å–∫–æ–≤ –∏–ª–∏ –ø–æ–¥—Ö–æ–¥–∞ –≤–Ω–æ—Å—è—Ç—Å—è —Å—é–¥–∞ –¥–æ –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç._

**–î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 2025-10-15 03:15
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.2.0 (–¥–æ–±–∞–≤–ª–µ–Ω Sprint 4 - –£–Ω–∏–≤–µ—Ä—Å–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞)
